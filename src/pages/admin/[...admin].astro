---
import { Admin } from "bknd/ui";
import "bknd/dist/styles.css";
import { getApi } from "@/bknd.ts";

const api = await getApi(Astro.request.headers, { verify: true, mode: "dynamic" });
const user = api.getUser() ?? undefined;

if (Astro.url.pathname === "/admin/auth/login") {
  return Astro.redirect("/login");
}

if (Astro.url.pathname === "/admin/auth/register") {
  return Astro.redirect("/register");
}
---

<html>
  <body>
    <Admin
      withProvider={{
        user
      }}
      config={{
        basepath: "/admin",
        theme: "system",
        logo_return_path: "/../"
      }}
      client:only="react"
    />
  </body>
</html>
